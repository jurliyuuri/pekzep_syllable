## 音節数と頻度のデータ

中国語の字ごとの頻度は $P(n) = \frac{A \exp(-an)}{n^b}$ という頻度で与えられると、http://journals.sagepub.com/doi/pdf/10.1177/016555159402000208 が引用している http://aapt.scitation.org/doi/pdf/10.1119/1.16476 に書いてある。

log-logを取って、$\log n = x$ とおけば、 $\log(P(n)) = \log A -bx -ae^x$ 。  
語彙は double-power law（レアな語がどんどん登場するため、log-log で折れ線で近似できる）だが、  
字の種類というのは、種類に上限があるため、低頻度を見ていくと「ある程度までは直線に伸びるものの、途中から一気に抑制されて下にガクンと落ちる」という挙動が発生するのだ。

中国語の音節（声調つき）についてこれの curve-fitting を試みると、  
字よりも音節はさらに hard limit が強く、exponential でも生ぬるいという感触になった。

壁 $w$ を用意して、$\log(P(n)) = c - bx -a/(x+w)$ ぐらいしてやると、中国語のデータにかなりよくフィットした。

- $c=-2.9287$
- $b=0.536423$
- $a=-1.86043$
- $w=-7.34501$

が、https://lingua.mtsu.edu/chinese-computing/phonology/syllabletone.php のを非常によく近似する。

ここで $e^{-w} = 1548.5$ は「少々オーバーに見積もった、hard wall」と見てよい。中国語の音節数はよく 1300 と言われていることにもよく合致する。

https://www.desmos.com/calculator/hl58mi3hg4?lang=ja


## パイグ語を当てはめる

さて、我々の元には、「331 個のポピュラーな語を選んだときに 10 ペアの衝突が発生した」というデータがある。  
https://docs.google.com/spreadsheets/d/1JbnAT66IyB_VByhQhGpox6KTm9A4ao5TIXmT451iVGo/edit?gid=0#gid=0

- a: 【之】vs.【噫/吁/嗚】
- am: 【御】（尊敬すべき）vs.【御】（～化する。cf. am zie1）
- ua: 【而】vs. 【哇】
- po1: 【道】vs.【羊】
- co1: 【散】vs.【壁】
- tuk2: 【巫】vs.【網】
- lok1: 【寒】vs.【笛/笙】
- kan1: 【火】vs.【躍】
- kuak1: 【父】vs.【㕮】
- kuai1: 【謝】vs.【翰/纂】

### まず、誤って一様分布を仮定する

我々は神であるため、「新規に出てきた 1 音節語根に神が音節を割り当てたいとき、どの確率で頻度 rank の音節を割り当てるか」という確率、p_乙(rank) を知りたい。

ここで、とりあえず p_乙(rank) としてまずは「最もよろしくないが、最もパラメータの数が少ない」分布であるところの一様分布（壁： $W$ 種）で考える。

「$W$ 面ダイスを 331 回振って、ちょうど 10 ペアの衝突が起こる」という確率を最大化する最尤推定をしよう。<br>
分母が $W^331$ 通り。<br>
分子が「W 個から 10 個選ぶ」×「(W-10) 個から 311 個選ぶ」× (331! / 2^10) 通り。

定数項を無視すると、$W^{-331} \cdot W! / (W-321)!$ を最大化する W を求めることになる。<br>
計算してみよう。

```js
const f = w => Array.from({length: 321}, (_, i) => Math.log(w-i)).reduce((a, b) => a+b) - 331 * Math.log(w);
let tmp = -1/0;
let ans = 0;
for (let k = 321; k <= 10000; k++) {
    if (f(k) > tmp) { tmp = f(k); ans = k; }
} 
console.log(ans, f(ans))
```

すると、W = 5351 のときが尤度最大という結果になる。<br>

実際、 $\ln\left(\frac{x+1}{x-320}\right)$ と $331\ln\left(\frac{\left(x+1\right)}{x}\right)$ が等しくなるのが $x = 5350.2686$ であることからもわかる。

う～む、やはり一様分布を仮定するのはかなりよろしくないのだなぁ。

### 神はどんな分布を仮定すればいいのか

ところで、「真のコーパス」における音節ランキングが、壁 $w$ に対して $\log(P(n)) = c - bx -a/(x+w)$ (where $\log n = x$) となるのだと我々は期待している。

「1 音節語根だけで構成した真のコーパスが与えられたとき、そのコーパスから 1 音節語根を選んだときに、頻度 rank の語根が選ばれる」
という確率が p_甲(rank) である。
